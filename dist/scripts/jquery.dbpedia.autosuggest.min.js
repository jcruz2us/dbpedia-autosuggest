!function(t){function e(e,n){this.element=e,this.settings=t.extend({},i,n),this._defaults=i,this._name=s,this.init()}var s="dbpediaAutosuggest",i={propertyName:"value"};e.prototype={init:function(){this.$results=t("<div class='dbpedia-autosuggest'></div>").appendTo("body"),this.monitorInput(),this.dismissOnOutsideClick()},monitorInput:function(){var e=this;t(this.element).on("focus",function(){e.positionPane(),e.search()}),t(this.element).on("keyup",function(){e.positionPane(),e.search()})},executeSearch:function(e){var s=this,i="http://lookup.dbpedia.org/api/search/PrefixSearch?QueryClass=&MaxHits=10&QueryString="+e,n={url:i,headers:{Accept:"application/json"}};this.positionPane(),this.$results.empty(".status").prepend("<div class='status'>Searching...</div>"),t.ajax(n).then(function(t){s.lastSearch={query:e,results:t.results},s.$results.empty(".status"),s.displayResults(t.results)})},search:function(){var e=this,s=this.$results,i=t(e.element).val();i?e.lastSearch&&e.lastSearch.query===i||(e.searchThrottle&&(clearTimeout(e.searchThrottle),e.searchThrottle=null),e.searchThrottle=setTimeout(function(){e.executeSearch(t(e.element).val())},250)):s.empty(".status").prepend("<div class='status'>Start typing to get some suggestions...</div>"),s.addClass("in")},displayResults:function(e){var s=this;if(this.positionPane(),!e.length)return void this.$results.off("click","li").empty().append("<div class='status'>No Suggestions</div>");for(var i=t("<ul/>"),n=0;n<e.length;n++){var a=e[n].classes,l=a&&a.length?a[0].label:"",r=e[n].label;t("<li>"+r+"<br/><i>"+l+"</i></li>").data("dbpedia-result",e[n]).appendTo(i)}this.$results.off("click","li").append(i).addClass("in").on("click","li",function(){var e=t(this).data("dbpedia-result");t(s.element).val(e.label),t(s.element).trigger("dbpedia.select",e),s.$results.removeClass("in")})},positionPane:function(){var e=t(this.element).offset();e.top+=t(this.element).outerHeight(),this.$results.css("position","absolute").css(e)},dismissOnOutsideClick:function(){var e=this,s=e.$results,i=t(e.element);t("body").on("click",function(n){var a=s.is(n.target)||t.contains(s[0],n.target),l=i.is(n.target);a||l||e.$results.removeClass("in")})}},t.fn[s]=function(i){return this.each(function(){t.data(this,"plugin_"+s)||t.data(this,"plugin_"+s,new e(this,i))}),this}}(jQuery,window,document);